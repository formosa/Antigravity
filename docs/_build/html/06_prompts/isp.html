

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ISP — Implementation Stubs (Prompts) &mdash; Maggie 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-data-viewer/jsonview.bundle.css?v=f6ef2277" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/libs/html/datatables.min.css?v=4b4fd840" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/needstable.css?v=5e1b6797" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_core.css?v=f5b60a78" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_links.css?v=2150a916" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_style.css?v=92936fa5" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_toggle.css?v=5c6620df" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/modern.css?v=803738c0" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=1400dff7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/sphinx-data-viewer/jsonview.bundle.js?v=18cd53c5"></script>
      <script src="../_static/sphinx-data-viewer/jsonview_loader.js?v=f7ff7e7d"></script>
      <script src="../_static/sphinx-needs/libs/html/datatables.min.js?v=8a4aee21"></script>
      <script src="../_static/sphinx-needs/libs/html/datatables_loader.js?v=a2cae175"></script>
      <script src="../_static/sphinx-needs/libs/html/sphinx_needs_collapse.js?v=dca66431"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Reconciliation Manifest: 06 Prompts" href="reconciliation_manifest.html" />
    <link rel="prev" title="06_prompts" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Maggie
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../00_glossary/index.html">Glossary of Controlled Terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_requirements/index.html">01_requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_specifications/index.html">02_specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_architecture/index.html">03_architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_data/index.html">04_data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_design/index.html">05_design</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">06_prompts</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">ISP — Implementation Stubs (Prompts)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconciliation_manifest.html">Reconciliation Manifest: 06 Prompts</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Maggie</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">06_prompts</a></li>
      <li class="breadcrumb-item active">ISP — Implementation Stubs (Prompts)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/06_prompts/isp.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="isp-implementation-stubs-prompts">
<h1>ISP — Implementation Stubs (Prompts)<a class="headerlink" href="#isp-implementation-stubs-prompts" title="Link to this heading"></a></h1>
<p>Python Implementation Stubs</p>
<div class="need_container docutils container" id="SNCB-df9aaa4a">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-1">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">Stub: Core Process</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-1" title="ISP-1">ISP-1</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><a class="reference internal" href="../05_design/tdd.html#TDD-1" title="ISP-1">TDD-1</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p><strong>Implementation Requirements:</strong></p></td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-d7ad4948">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-1.1">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">**Class Structure:** Inherit structure from `CoreProcess` blueprint.</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-1.1" title="ISP-1.1">ISP-1.1</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><span class="needs_dead_link forbidden">TDD-1.1</span>, <a class="reference internal" href="../05_design/tdd.html#TDD-1" title="ISP-1.1">TDD-1</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"></td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-1dd959b5">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-1.2">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">**Socket:** Bind `ROUTER` using config from `ICD-1`.</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-1.2" title="ISP-1.2">ISP-1.2</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><span class="needs_dead_link forbidden">TDD-1.3</span>, <a class="reference internal" href="../04_data/icd.html#ICD-1" title="ISP-1.2">ICD-1</a>, <a class="reference internal" href="../05_design/tdd.html#TDD-1" title="ISP-1.2">TDD-1</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"></td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-56452a4b">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-1.3">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">**Orchestration:** Initialize `active_requests` dict and `PriorityQueue`.</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-1.3" title="ISP-1.3">ISP-1.3</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><span class="needs_dead_link forbidden">TDD-1.5</span>, <a class="reference internal" href="../05_design/tdd.html#TDD-1" title="ISP-1.3">TDD-1</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"></td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-e965b184">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-1.4">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">**HSM:** Setup `transitions.Machine` with states from `FSD-2`.</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-1.4" title="ISP-1.4">ISP-1.4</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><span class="needs_dead_link forbidden">TDD-1.6</span>, <span class="needs_dead_link forbidden">FSD-2.3</span>, <a class="reference internal" href="../02_specifications/fsd.html#FSD-2" title="ISP-1.4">FSD-2</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>import zmq
import yaml
import queue
import itertools
import threading
from transitions import Machine</p>
<dl>
<dt>class CoreProcess:</dt><dd><p>“””
Orchestrates IPC between services using ZeroMQ ROUTER pattern.
“””
def __init__(self, config_path: str):</p>
<blockquote>
<div><p>“””
Initialize ZMQ Context, Bind ROUTER.
Init self.active_requests = {} (ID -&gt; Identity, Ts, Cmd).
Init self.queue = PriorityQueue(maxsize).
Init self.counter = itertools.count().
“””
pass</p>
</div></blockquote>
<dl class="simple">
<dt>def _start_receiver_thread(self) -&gt; None:</dt><dd><p>“””
Spawns a daemon thread running a ZMQ Poller.
Parse: [client_identity, b’’, metadata, payload…]
Put (priority, next(counter), (client_identity, frames)) into queue.
“””
pass</p>
</dd>
<dt>def run(self) -&gt; None:</dt><dd><p>“””
Main Event Loop.
1. Process self.queue (Priority).
2. Check timeouts in self.active_requests (&gt;5.0s).
3. Drive HSM transitions (enter_processing, enter_error).
“””
pass</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-1d0b041e">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-2">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">Stub: Service Client</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-2" title="ISP-2">ISP-2</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><a class="reference internal" href="../05_design/tdd.html#TDD-2" title="ISP-2">TDD-2</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p><strong>Implementation Requirements:</strong></p></td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-4cda438c">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-2.1">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">**Base Class:** Define `ServiceClient` for UI/Runtime/Audio.</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-2.1" title="ISP-2.1">ISP-2.1</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><span class="needs_dead_link forbidden">TDD-2.1</span>, <a class="reference internal" href="../05_design/tdd.html#TDD-2" title="ISP-2.1">TDD-2</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"></td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-e389e0fd">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-2.2">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">**Connectivity:** Setup `DEALER` (Command) and `PUSH` (Log) sockets.</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-2.2" title="ISP-2.2">ISP-2.2</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><span class="needs_dead_link forbidden">TDD-2.4</span>, <span class="needs_dead_link forbidden">TDD-2.5</span>, <a class="reference internal" href="../05_design/tdd.html#TDD-2" title="ISP-2.2">TDD-2</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"></td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-3ff1d38b">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-2.3">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">**Threading:** Implement `_receiver_thread` to populate internal `PriorityQueue`.</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-2.3" title="ISP-2.3">ISP-2.3</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><span class="needs_dead_link forbidden">TDD-2.6</span>, <a class="reference internal" href="../05_design/tdd.html#TDD-2" title="ISP-2.3">TDD-2</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<dl>
<dt>class ServiceClient:</dt><dd><p>“””
Standard client for Service processes.
Maintains DEALER (Command) and PUSH (Log) sockets.
“””
def __init__(self, service_name: str, config_path: str):</p>
<blockquote>
<div><p>“””
Connects DEALER and PUSH sockets based on <a href="#id1"><span class="problematic" id="id2">|ICD-1|</span></a>.
Sets PUSH socket to SNDHWM=1, LINGER=0 (Fire-and-Forget).
Starts receiver thread.
“””
pass</p>
</div></blockquote>
<dl class="simple">
<dt>def send_request(self, command: str, payload: dict, priority: int = 1) -&gt; None:</dt><dd><p>“””
Constructs metadata <a href="#id3"><span class="problematic" id="id4">|ICD-3|</span></a> and sends via DEALER.
“””
pass</p>
</dd>
<dt>def send_log(self, level: str, message: str, request_id: str = None) -&gt; None:</dt><dd><p>“””
Fire-and-forget log emission.
Constructs frame: [Metadata(<a href="#id5"><span class="problematic" id="id6">|ICD-3|</span></a>), Message].
Must swallow zmq.Again exceptions.
“””
pass</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-2a3e1af3">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-3">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">Stub: LogServer Sink</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-3" title="ISP-3">ISP-3</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><a class="reference internal" href="../05_design/tdd.html#TDD-3" title="ISP-3">TDD-3</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p><strong>Implementation Requirements:</strong></p></td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-16c1efa7">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-3.1">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">**Socket:** Bind `PULL` socket for aggregation.</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-3.1" title="ISP-3.1">ISP-3.1</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><span class="needs_dead_link forbidden">TDD-3.3</span>, <a class="reference internal" href="../05_design/tdd.html#TDD-3" title="ISP-3.1">TDD-3</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"></td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-a52cce57">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-3.2">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">**Performance:** Use 1ms poll timeout for high throughput.</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-3.2" title="ISP-3.2">ISP-3.2</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><span class="needs_dead_link forbidden">TDD-3.4</span>, <a class="reference internal" href="../05_design/tdd.html#TDD-3" title="ISP-3.2">TDD-3</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"></td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-e532c23f">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-3.3">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">**Storage:** Configure `loguru` rotation/retention policies.</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-3.3" title="ISP-3.3">ISP-3.3</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><span class="needs_dead_link forbidden">TDD-3.6</span>, <a class="reference internal" href="../05_design/tdd.html#TDD-3" title="ISP-3.3">TDD-3</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>from loguru import logger</p>
<dl>
<dt>class LogServerSink:</dt><dd><p>“””
Aggregates logs from all services via PULL socket.
“””
def __init__(self, config_path: str):</p>
<blockquote>
<div><p>“””
Bind PULL socket.
Configure Loguru (Rotation: 50MB, Retention: 30 Days).
“””
pass</p>
</div></blockquote>
<dl class="simple">
<dt>def run(self) -&gt; None:</dt><dd><p>“””
Tight Poll Loop (1ms).
Parse [metadata, message] -&gt; logger.log().
“””
pass</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-bf87851e">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-4">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">Stub: Tool/Routine Interface</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-4" title="ISP-4">ISP-4</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><a class="reference internal" href="../05_design/tdd.html#TDD-4" title="ISP-4">TDD-4</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p><strong>Implementation Requirements:</strong></p></td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-12242e17">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-4.1">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">**Extensibility:** Define `AbstractTool` and `AbstractRoutine` using `ABC`.</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-4.1" title="ISP-4.1">ISP-4.1</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><span class="needs_dead_link forbidden">TDD-4.1</span>, <a class="reference internal" href="../05_design/tdd.html#TDD-4" title="ISP-4.1">TDD-4</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"></td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-14505a38">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-4.2">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">**Contract:** Enforce `initialize`, `get_hsm_states`, and `handle_event`.</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-4.2" title="ISP-4.2">ISP-4.2</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><span class="needs_dead_link forbidden">TDD-4.2</span>, <span class="needs_dead_link forbidden">TDD-4.3</span>, <span class="needs_dead_link forbidden">TDD-4.4</span>, <a class="reference internal" href="../05_design/tdd.html#TDD-4" title="ISP-4.2">TDD-4</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>from abc import ABC, abstractmethod
from typing import List, Dict</p>
<dl>
<dt>class AbstractTool(ABC):</dt><dd><p>“””
Interface for modular functional assets.
“””
&#64;abstractmethod
def initialize(self, core_context) -&gt; None:</p>
<blockquote>
<div><p>pass</p>
</div></blockquote>
<p>&#64;abstractmethod
def get_hsm_states(self) -&gt; List[Dict]:</p>
<blockquote>
<div><p>“””Return state definitions for dynamic compilation.”””
pass</p>
</div></blockquote>
<p>&#64;abstractmethod
def handle_event(self, event_data: Dict) -&gt; str:</p>
<blockquote>
<div><p>“””Process logic and return next trigger.”””
pass</p>
</div></blockquote>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-ae7bbd32">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-5">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">Stub: Audio Worker Loop</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-5" title="ISP-5">ISP-5</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><a class="reference internal" href="../02_specifications/fsd.html#FSD-4" title="ISP-5">FSD-4</a>, <a class="reference internal" href="../01_requirements/nfr.html#NFR-3" title="ISP-5">NFR-3</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p><strong>Implementation Requirements:</strong></p></td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-30dd63e5">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-5.1">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">**Logic:** Implement Wake Word -&gt; VAD -&gt; STT pipeline.</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-5.1" title="ISP-5.1">ISP-5.1</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><a class="reference internal" href="../02_specifications/fsd.html#FSD-4" title="ISP-5.1">FSD-4</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"></td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-db056e0e">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_test docutils align-default" id="ISP-5.2">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Prompt</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">**Constraint:** Check Core State (`idle`) before sending Wake Word events.</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#ISP-5.2" title="ISP-5.2">ISP-5.2</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span></span></span></div>
<div class="line"><span><div class="line">links outgoing: <span class="links"><span><span class="needs_dead_link forbidden">FSD-4.2</span>, <a class="reference internal" href="../02_specifications/fsd.html#FSD-4" title="ISP-5.2">FSD-4</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<dl>
<dt>def audio_worker_loop(client: ServiceClient):</dt><dd><p>“””
Real-time audio processing loop.
“””
# Setup pvporcupine (Wake Word) and webrtcvad (VAD)</p>
<dl class="simple">
<dt>while True:</dt><dd><p># 1. Read Audio Chunk
# 2. Denoise
# 3. Check Wake Word -&gt; client.send_request(“WAKE_WORD”) IF Core is IDLE
# 4. Check VAD -&gt; Buffer for STT
# 5. Handle inbound IPC messages (client.poll_queue)
pass</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="06_prompts" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="reconciliation_manifest.html" class="btn btn-neutral float-right" title="Reconciliation Manifest: 06 Prompts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Antigravity.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>