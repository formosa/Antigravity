
## 25. Maintenance & Evolution Guidelines

### 25.1 Documentation Lifecycle Phases

**Phase 1: Initial Development (Greenfield)**

-   Create tags sequentially from BRD → ISP
-   Maintain clean reconciliation manifests
-   All tags cite parents immediately upon creation

**Phase 2: Feature Addition (Incremental)**

-   Append new tags to existing blocks (e.g., |FSD-21| after |FSD-20|)
-   Cite existing tags where appropriate
-   Update reconciliation manifests with new tag counts

**Phase 3: Refactoring (Restructuring)**

-   Mark old tags as DEPRECATED, create new tags
-   Maintain migration map (Section 22.3)
-   Update all downstream citations in single commit

**Phase 4: Sunsetting (Feature Removal)**

-   Never delete tags, mark as [REMOVED vX.Y]
-   Document replacement feature (if any)
-   Orphan check: Ensure no active tags cite removed ones

### 25.2 Version Control Best Practices

**Commit Message Format:**

```
[DDR] <Tier>: <Summary>

- Added: |TAG-1|, |TAG-2|
- Modified: |TAG-3| (reason: performance target increased)
- Deprecated: |TAG-4| → |TAG-5|

Traceability: |TAG-1| ← |PARENT|
Reconciliation: fsd-root manifest updated (+2 tags)

```

**Branch Strategy:**

-   `main`: Stable, reconciled documentation
-   `feature/<name>`: New feature documentation (BRD → ISP)
-   `refactor/<name>`: Tag restructuring
-   `bugfix/<id>`: Documentation corrections

**Pull Request Checklist:**

```markdown
- [ ] All new tags have parent citations
- [ ] Reconciliation manifests updated
- [ ] No broken citations (automated check passes)
- [ ] Rationale provided for design decisions
- [ ] Implementation stubs include traceability markers
- [ ] Anti-pattern check passed (no tech in BRD, etc.)

```

### 25.3 Automated Validation Tools

**Pseudocode for CI/CD Integration:**

```python
def validate_ddr(documentation_file: str) -> ValidationReport:
    """
    Automated DDR integrity validation.

    Checks
    ------
    1. Citation integrity (all parents exist)
    2. Inventory accuracy (tag count matches manifest)
    3. Orphan detection (tags without parents, except BRD root)
    4. Anti-pattern detection (technology in BRD, etc.)
    5. Format compliance (tag syntax, YAML schema)

    Returns
    -------
    ValidationReport
        Pass/fail status with detailed error list
    """
    report = ValidationReport()

    # Parse documentation
    doc = parse_restructured_text(documentation_file)

    # Check 1: Citation integrity
    for tag, content in doc.tags.items():
        parents = extract_citations(content)
        for parent in parents:
            if parent not in doc.tags:
                report.errors.append(f"{tag} cites missing parent {parent}")

    # Check 2: Inventory accuracy
    for section in doc.sections:
        manifest = section.reconciliation_manifest
        actual_count = len([t for t in doc.tags if t.startswith(section.prefix)])
        if actual_count != manifest.tag_count:
            report.errors.append(
                f"{section.id}: Manifest says {manifest.tag_count}, "
                f"found {actual_count} tags"
            )

    # Check 3: Orphan detection
    orphans = detect_upward_orphans(doc.tags)
    report.warnings.extend(orphans)

    # Check 4: Anti-patterns
    for tag, content in doc.tags.items():
        if tag.startswith("BRD") and contains_technology_reference(content):
            report.errors.append(f"{tag}: Technology leak in BRD tier")

    # Check 5: Format compliance
    for tag in doc.tags.keys():
        if not validate_tag_format(tag):
            report.errors.append(f"{tag}: Invalid tag format")

    report.status = "PASS" if len(report.errors) == 0 else "FAIL"
    return report

```

----------
