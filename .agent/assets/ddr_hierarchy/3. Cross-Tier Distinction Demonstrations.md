
## 3. Cross-Tier Distinction Demonstrations

### 3.1 Wake Word Detection Feature (Vertical Slice)

**BRD Perspective (Why):**

~~~rst
.. brd:: Offline strategically focused framework.
   :id: BRD-5.1

   Offline, multi-process Python framework.

~~~

-   **Focus:** Business justification for voice interaction without internet

**NFR Perspective (Constraints):**

~~~rst
.. nfr:: Audio Priority: CPU-bound services must prioritize low-latency.
   :id: NFR-3.2

~~~

-   **Focus:** Performance constraint on wake word detection

**FSD Perspective (What):**

~~~rst
.. fsd:: Wake Word: Always-on detection using pvporcupine.
   :id: FSD-4.1

.. fsd:: Must only send WAKE_WORD_DETECTED if Core is in idle state.
   :id: FSD-4.2

~~~

-   **Focus:** Functional behavior and business rule

**SAD Perspective (How Structured):**

~~~rst
.. sad:: Receiver thread polls ZMQ socket, pushes to PriorityQueue.
   :id: SAD-4.1

~~~

-   **Focus:** Concurrency architecture for non-blocking wake word handling

**ICD Perspective (Contracts):**

~~~rst
.. icd:: Message Format: Wake Word Detection
   :id: ICD-3

   .. code-block:: json

      {
        "command": "WAKE_WORD_DETECTED",
        "priority": 0
      }

~~~

-   **Focus:** Exact message format sent by Audio Service

**TDD Perspective (Components):**

~~~rst
.. tdd:: UI: installEventFilter to catch Click-to-Wake events.
   :id: TDD-2.9

~~~

-   **Focus:** Component-level implementation requirement

**ISP Perspective (Code):**

~~~python
# |ISP-4|: "Audio Worker Loop Skeleton"

def audio_worker_loop(client: ServiceClient):
    """
    Main loop for wake word detection.

    References
    ----------
    |FSD-4.1|, |ICD-3|
    """
    # Setup pvporcupine
    if is_wake_word(audio_chunk):
        client.send_request("WAKE_WORD_DETECTED", ...)

~~~

-   **Focus:** Executable scaffold

### 3.2 Error Handling (Cross-Cutting Concern)

| Tier | Content | Distinction |
| :--- | :--- | :--- |
| **BRD** | `.. brd:: Reduce downtime` (ID: BRD-3.4) | Strategic goal |
| **NFR** | `.. nfr:: Service heartbeat 1s` (ID: NFR-5.2) | Operational constraint |
| **FSD** | `.. fsd:: Centralized error codes` (ID: FSD-7.2) | Feature requirement |
| **SAD** | `.. sad:: Supervisor Pattern` (ID: SAD-5.1) | Architectural choice |
| **ICD** | `.. icd:: Response Schema` (ID: ICD-4) | Data contract |
| **TDD** | `.. tdd:: health_check() method` (ID: TDD-1.9) | Component interface |
| **ISP** | `def check_timeouts(self): pass` | Code stub |

----------
